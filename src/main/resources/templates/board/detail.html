<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>게시판 세부</title>
    <Style>
        .board-edit{
            margin-top : 30px;
        }
    </Style>
</head>
<body>
    <div>
        <a href="main">게시판 메인으로 가기</a>
    </div>
    <div>
        <div>
            <h1 th:text="${detail.title}">제목</h1>
        </div>
        <div>
            작성자: <span th:text="${detail.writer}">writer</span>
        </div>
        <div>
            작성일: <span th:text="${detail.createdAt}">createdAt</span>
        </div>
        <div>
            내용: <p th:text="${detail.content}">content</p>
        </div>
    </div>
    <div class="board-edit">
        <button id="btn-board-update" th:data-id="${detail.boardId}">
            수정하기
        </button>
        <button id="btn-board-delete">
            삭제하기
        </button>
    </div>
</body>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script>
    $(function(){

        let boardId = $("#btn-board-update").data("id");

        $("#btn-board-update").on('click', function(){
            window.location.href="/board/edit?id="+boardId;
        });


        $("#btn-board-delete").on('click', function(){
           let chk = confirm("정말 삭제하시겠습니까?");

           if(chk == false){
                return;
           }

           $.ajax({
              url: "/api/board/delete/"+boardId,
              type: "DELETE",
              dataType: "json",
              success: function(result){
                  if(result.success){
                    alert("삭제완료되었습니다.");
                    location.href="/board/main";
                  }else{
                    alert(result.message || "삭제하는 것을 실패하였습니다.");
                  }
              },
              error: function(xhr, status, error) {
                console.error("Error deleting board:", error);
                alert("삭제 중 오류가 발생했습니다.");
              }
           });
        });
   });
</script>
</html>